# üí° –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

## ‚ùì –í–æ–ø—Ä–æ—Å 1: –ß–µ–º—É –Ω–∞—É—á–∏—Ç—Å—è –º–æ–¥–µ–ª—å –ë–ï–ó –∑–Ω–∞–Ω–∏—è —Å–ª–æ–≤?

### –ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: **–ù–ò–ß–ï–ú–£ –ø–æ–ª–µ–∑–Ω–æ–º—É**

### –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π:
- –ù–µ –∑–Ω–∞–µ—Ç –∞–ª—Ñ–∞–≤–∏—Ç–∞
- –ù–µ –≤–∏–¥–µ–ª –Ω–∏ –æ–¥–Ω–æ–π –∫–Ω–∏–≥–∏
- –ù–µ —Å–ª—ã—à–∞–ª —Ä–µ—á–∏

–ò –µ–≥–æ –ø—Ä–æ—Å—è—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —Ä–æ–º–∞–Ω. –ß—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è?

```
–ü–æ–ø—ã—Ç–∫–∞ 1:    "fgjhsdfkj sdfgjhkl sdfghj"
–ü–æ–ø—ã—Ç–∫–∞ 100:  "aaaaa bbbbb ccccc"  (–Ω–∞—à—ë–ª –ø–∞—Ç—Ç–µ—Ä–Ω –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
–ü–æ–ø—ã—Ç–∫–∞ 1000: "abc abc abc abc"   (—Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
```

### –ö —á–µ–º—É –ø—Ä–∏–¥—ë—Ç –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ –º–∏–ª–ª–∏–æ–Ω –∏—Ç–µ—Ä–∞—Ü–∏–π:

```python
# –ú–æ–¥–µ–ª—å "–≤—ã—É—á–∏—Ç":
‚úì –ß—Ç–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω—ã "—Å—Ç–∞–±–∏–ª—å–Ω–µ–µ"
‚úì –ß—Ç–æ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—â–µ
‚úì –ß—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —á–∏—Å–µ–ª —á–∞—â–µ –¥—Ä—É–≥–∏—Ö

# –ú–æ–¥–µ–ª—å –ù–ï –≤—ã—É—á–∏—Ç:
‚úó –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–≤–∞
‚úó –ö–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
‚úó –°–º—ã—Å–ª —Ç–µ–∫—Å—Ç–∞
‚úó –ì—Ä–∞–º–º–∞—Ç–∏–∫—É
‚úó –Ø–∑—ã–∫ –≤–æ–æ–±—â–µ
```

### –ê–Ω–∞–ª–æ–≥–∏—è:

**–ö–∞–∫ –ü–æ–ø—É–≥–∞–π:**
- –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–≤—É–∫–∏, –Ω–µ –ø–æ–Ω–∏–º–∞—è —Å–º—ã—Å–ª–∞
- –ú–æ–∂–µ—Ç –≤—ã—É—á–∏—Ç—å "–ø–∞—Ç—Ç–µ—Ä–Ω—ã" ("–ü—Ä–∏–≤–µ—Ç-–ø—Ä–∏–≤–µ—Ç")
- –ù–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç

**–ú–æ–¥–µ–ª—å –±–µ–∑ —Å–ª–æ–≤:**
- "–í—ã—É—á–∏—Ç" —á—Ç–æ `[1,2,3]` —á–∞—Å—Ç–æ –∏–¥—É—Ç –≤–º–µ—Å—Ç–µ
- –ë—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–æ —ç—Ç–æ –Ω–µ —Ç–µ–∫—Å—Ç, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–∞

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏:

```python
# –ë–µ–∑ –∑–Ω–∞–Ω–∏—è —è–∑—ã–∫–∞ –º–æ–¥–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç:
Loss = entropy(output)  # –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ö–∞–æ—Å

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
output = [1, 2, 3, 1, 2, 3, 1, 2, 3, ...]  # –ù–∏–∑–∫–∏–π entropy!

# –ù–æ —ç—Ç–æ –ù–ï —è–∑—ã–∫!
decode([1,2,3,1,2,3]) = "??? ??? ???"  # –ë–µ—Å—Å–º—ã—Å–ª–∏—Ü–∞
```

### –ü–æ—á–µ–º—É AlphaZero —Ä–∞–±–æ—Ç–∞–µ—Ç, –∞ —ç—Ç–æ –Ω–µ—Ç:

| –®–∞—Ö–º–∞—Ç—ã (AlphaZero) | –Ø–∑—ã–∫ (LLM) |
|---------------------|------------|
| –ü—Ä–∞–≤–∏–ª–∞ —á—ë—Ç–∫–∏–µ | –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑–º—ã—Ç—ã–µ |
| –û—Ü–µ–Ω–∫–∞: –ø–æ–±–µ–¥–∞/–ø–æ—Ä–∞–∂–µ–Ω–∏–µ | –û—Ü–µ–Ω–∫–∞: —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è |
| 10^43 —Å–æ—Å—Ç–æ—è–Ω–∏–π | ‚àû –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ |
| Self-play –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–µ–Ω | –ù—É–∂–Ω–æ –∑–Ω–∞–Ω–∏–µ —è–∑—ã–∫–∞ |

### –í—ã–≤–æ–¥:

**–ú–æ–¥–µ–ª—å –ë–ï–ó —Å–ª–æ–≤ –Ω–∞—É—á–∏—Ç—Å—è:**
- –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ù–∞—Ö–æ–¥–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ —à—É–º–µ
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π loss

**–ù–û —ç—Ç–æ –±—É–¥–µ—Ç:**
- –ë–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä —á–∏—Å–µ–ª
- –ù–µ —Ç–µ–∫—Å—Ç
- –ù–µ —è–∑—ã–∫
- –ë–µ—Å–ø–æ–ª–µ–∑–Ω–æ

**–ú–∏–Ω–∏–º—É–º –Ω—É–∂–µ–Ω:**
- –°–ª–æ–≤–∞—Ä—å (100-1000 —Å–ª–æ–≤)
- Seed –ø—Ä–∏–º–µ—Ä—ã (10-100 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π)
- –§—É–Ω–∫—Ü–∏—è –æ—Ü–µ–Ω–∫–∏ "—Ö–æ—Ä–æ—à–µ–≥–æ" —Ç–µ–∫—Å—Ç–∞

---

## ‚ùì –í–æ–ø—Ä–æ—Å 2: Pause/Resume —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∏—Ç–µ—Ä–∞—Ü–∏–π

### ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û!

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ:

#### 1. **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ:**
```python
trainer.stop_training()  # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞—Ç—á–∞
# –ò–ª–∏ Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
```

#### 2. **–í–æ–∑–æ–±–Ω–æ–≤–ª—è—Ç—å —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞:**
```python
trainer.train_continuous(
    max_iterations=1000,
    resume_from='checkpoint.pt'  # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç
)
```

#### 3. **–ò–∑–º–µ–Ω—è—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π:**
```python
# –ë—ã–ª–æ: –æ–±—É—á–∏–ª –¥–æ 1000
trainer.train_continuous(max_iterations=1000)

# –°—Ç–∞–ª–æ: —Ö–æ—á—É –¥–æ 5000!
trainer.train_continuous(
    max_iterations=5000,  # –ò–ó–ú–ï–ù–ò–õ!
    resume_from='model_iter_1000.pt'
)
# ‚Üí –û–±—É—á–∏—Ç —Å 1000 –¥–æ 5000 (+4000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
```

### –ü—Ä–∏–º–µ—Ä workflow:

```python
# –î–µ–Ω—å 1: –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
trainer.train_continuous(max_iterations=1000)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–æ—Ä–º, –ø—Ä–æ–¥–æ–ª–∂—É

# –î–µ–Ω—å 2: –°–µ—Ä—å—ë–∑–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
trainer.train_continuous(
    max_iterations=10000,
    resume_from='model_iter_1000.pt'
)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ—Ç–ª–∏—á–Ω–æ!

# –î–µ–Ω—å 3: –§–∏–Ω–∞–ª—å–Ω—ã–π –ø—É—à
trainer.train_continuous(
    max_iterations=100000,
    resume_from='model_iter_10000.pt'
)
# –ò—Ç–æ–≥–æ: 100K –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ—ç—Ç–∞–ø–Ω–æ
```

### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

```python
checkpoint = {
    'model_state_dict': ...,      # –í–µ—Å–∞
    'optimizer_state_dict': ...,  # Momentum –∏ —Ç.–¥.
    'scheduler_state_dict': ...,  # Learning rate
    'iteration': 5432,             # –¢–µ–∫—É—â–∞—è
    'training_history': [...]      # –ò—Å—Ç–æ—Ä–∏—è
}
```

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:**
- ‚úÖ –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è —Ç–æ—á–Ω–æ
- ‚úÖ Optimizer –Ω–µ —Å–±—Ä–æ—Å–∏—Ç—Å—è
- ‚úÖ Learning rate –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –í –∫–æ–¥–µ
```python
from azr_trainer_resume import AZRTrainer

trainer = AZRTrainer(model, tokenizer)

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
trainer.train_continuous(max_iterations=1000)

# –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
trainer2 = AZRTrainer(model2, tokenizer)
trainer2.train_continuous(
    max_iterations=5000,
    resume_from='checkpoints/model_iter_1000.pt'
)
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ UI (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)
```javascript
// –ö–Ω–æ–ø–∫–∞ Stop
<button onclick="stopTraining()">‚è∏Ô∏è  Stop</button>

// –§–æ—Ä–º–∞ Resume
<input id="new_iterations" placeholder="–ù–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ">
<button onclick="resumeTraining()">‚ñ∂Ô∏è  Resume</button>
```

### –§–∞–π–ª—ã:

1. **azr_trainer_resume.py** - –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è trainer
2. **example_pause_resume.py** - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
3. **PAUSE_RESUME_GUIDE.md** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:

```bash
python example_pause_resume.py
```

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –û–±—É—á–µ–Ω–∏–µ ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Üí –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–π –Ω–∞ –ª–µ—Ç—É
- –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ Ctrl+C

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤:

| –í–æ–ø—Ä–æ—Å | –ë–µ–∑ –¥–∞–Ω–Ω—ã—Ö | –ú–∏–Ω–∏–º—É–º –¥–∞–Ω–Ω—ã—Ö | –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
|--------|-----------|----------------|---------------|
| **–ß—Ç–æ –Ω—É–∂–Ω–æ** | –ù–∏—á–µ–≥–æ | 10-100 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π | 100+ MB —Ç–µ–∫—Å—Ç–∞ |
| **–†–µ–∑—É–ª—å—Ç–∞—Ç** | –®—É–º | –ë–∞–∑–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã | –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç |
| **Self-play** | –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | –†–∞–±–æ—Ç–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ | –î–æ–ø–æ–ª–Ω—è–µ—Ç |
| **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** | ‚ùå | –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã | –ü—Ä–æ–¥–∞–∫—à–Ω |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

**–î–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:**
```python
seed = "10-20 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π"
train(texts=[seed], max_iterations=10000)
# + 80% self-play
```

**–î–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á:**
```python
book = "1-5 MB —Ç–µ–∫—Å—Ç–∞"
train(texts=[book], max_iterations=100000)
# + 20% self-play
```

---

## üéØ –ò—Ç–æ–≥–æ:

### –û—Ç–≤–µ—Ç 1: –ë–µ–∑ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ú–æ–¥–µ–ª—å –Ω–µ –≤—ã—É—á–∏—Ç —è–∑—ã–∫
- ‚úì –ù–æ –º–æ–∂–Ω–æ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º seed (10-100 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π)
- ‚úì Self-play –ø–æ–º–æ–≥–∞–µ—Ç, –Ω–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ

### –û—Ç–≤–µ—Ç 2: Pause/Resume
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ azr_trainer_resume.py
- ‚úÖ –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å max_iterations
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ Ctrl+C

---

**–§–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:**

1. `TRAINING_COMPARISON.md` - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤
2. `pure_selfplay_experiment.py` - —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
3. `minimal_seed_training.py` - –æ–±—É—á–µ–Ω–∏–µ —Å –º–∏–Ω–∏–º—É–º–æ–º
4. `azr_trainer_resume.py` - –Ω–æ–≤—ã–π trainer
5. `example_pause_resume.py` - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è
6. `PAUSE_RESUME_GUIDE.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!** üöÄüß†‚ú®
